# 鉄道模型車両管理アプリ 開発記録

## プロジェクト概要
Nゲージ鉄道模型の車両情報と保有状況を管理するWebアプリケーション

## 開発進捗

### 完了済み
- [x] プロジェクト要件定義（specification.md）
- [x] ディレクトリ構造設計（rules.md）
- [x] UIワイヤーフレーム作成（5画面）
- [x] CLAUDE.md作成
- [x] 既存データ確認（CSV形式）
- [x] 認証方式をGoogle OAuthに簡素化決定

### Phase 1: プロジェクト基盤構築

#### 1.1 Next.jsプロジェクト作成
- [x] `apps/web-next/` 配下にNext.js 15.5.3プロジェクト作成
- [x] TypeScript + Tailwind CSS + ESLint設定
- [x] フォルダ構造整備
- [x] 基本的な型定義ファイル作成

#### 1.2 開発環境セットアップ
- [x] package.json設定（pnpmワークスペース対応）
- [x] 必要ライブラリ導入：
  - [x] @supabase/supabase-js, prisma
  - [x] next-auth（GoogleProviderのみ）
  - [x] lucide-react, @headlessui/react
  - [x] react-hook-form, zod
- [x] 環境変数設定ファイル作成
- [x] 基本的なlib設定ファイル作成

### Phase 2: 基本機能実装

#### 2.1 認証システム（優先実装）
- [x] NextAuth.js Google OAuth設定
- [x] Google Cloud Console設定（本番環境対応）
- [x] ログイン画面（Googleボタンのみ）
- [x] Vercelデプロイ・認証システム動作確認
- [x] ユーザー自動作成機能（signInコールバック）
- [x] AuthGuard認証保護コンポーネント

#### 2.2 データベース環境構築
- [x] Vercel + Supabase統合環境設定
- [x] Prismaスキーマ作成・マイグレーション実行
- [x] データベース接続確認・テストAPI作成
- [x] 本番環境デプロイ確認

#### 2.3 製品情報機能
- [x] 製品一覧画面（検索・フィルタ・ページネーション）
- [x] 製品詳細画面（基本情報・実車情報・保有状況）
- [x] 製品API実装（CRUD操作）
- [x] Vercelデプロイ確認
- [x] 製品追加フォーム画面
- [x] 製品編集フォーム画面

#### 2.4 保有車両機能
- [x] 保有車両一覧画面（検索・フィルタ・認証制御）
- [x] 保有車両詳細画面（詳細情報・整備記録）
- [x] 保有車両API実装（認証付きCRUD操作）
- [x] ダッシュボード更新・ナビゲーション統合
- [x] Vercelデプロイ・エラー修正確認
- [x] 保有車両追加フォーム画面
- [ ] 保有車両編集フォーム画面

### Phase 2.5: セット管理機能実装
- [ ] セット構成車両管理機能
- [ ] 製品間の親子関係（parentCode）設定
- [ ] セット詳細画面での構成車両表示
- [ ] セット追加・編集フォームでの構成車両指定

### Phase 3: 詳細機能
- [ ] 整備記録機能
- [ ] 画像アップロード機能
- [ ] データエクスポート機能
- [ ] CSVインポート機能

## 技術仕様

### 使用技術
- **フロントエンド**: React (Next.js 14)
- **バックエンド**: Node.js (Next.js API Routes)
- **データベース**: PostgreSQL (Supabase)
- **認証**: NextAuth.js (Google OAuth)
- **UI**: Tailwind CSS + Headless UI
- **デプロイ**: Vercel

### データベース設計
主要テーブル:
- products（製品マスタ）
- users（ユーザー）
- owned_vehicles（保有車両）
- maintenance_records（整備記録）

### 既存データ
- `local/車両リスト - 車両商品情報.csv`: 製品マスタデータ
- `local/車両リスト - 保有車両.csv`: 保有車両データ

## 実装順序変更
認証システムを優先実装してデプロイ確認後、DB環境構築を行う方針に変更

## 現在の状況（2025年1月）

### 完成済み機能
- ✅ 認証システム（Google OAuth + 自動ユーザー作成）
- ✅ データベース統合（Supabase + Prisma）
- ✅ 製品情報機能（一覧・詳細・検索）
- ✅ 保有車両機能（一覧・詳細・認証制御）
- ✅ Vercel本番環境デプロイ

### 次の実装予定（Phase 2.5）
1. **保有車両編集フォーム** - 既存車両更新（Phase 2完了）
2. **セット構成車両管理機能** - 製品間の親子関係設定
3. **セット詳細画面拡張** - 構成車両一覧表示
4. **セットフォーム機能** - セット追加・編集での構成車両指定

### 実装方針
- **一画面ずつ段階的に実装**
- **react-hook-form + zod によるバリデーション**
- **作成→動作確認→デプロイのサイクル**



# メモ
## 追加・編集画面全般
- テキストの色が薄くてよく見えない
  - h2やselectアイテム
## 保有車両
### 管理ID
- 必須項目の見直し

### 購入日
- 不明なども入れたい
- 未設定も許容したい

### その他
- 実際には購入情報も必須っぽい動作になっているが、何も表示されないのでわかりにくい
- 価格なども未入力か不明を許容したい
